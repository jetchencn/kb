
**合同在数据建模中通常属于“星形模型”或“星座模型”**，具体取决于业务复杂度。用一句话概括：**合同是记录交易条款的“事实核心”，关联客户、产品、时间等维度表，若涉及履约跟踪则升级为星座模型**。

---

### **示例：销售合同模型拆解**
#### 1️⃣ **事实表（合同核心条款）**
| 合同ID | 签约日期ID | 客户ID | 产品ID | 合同金额 | 付款方式 | 履约状态 |  
|--------|------------|--------|--------|----------|----------|----------|  
| C20231001 | 20231001 | KH1001 | P3002 | 500,000  | 分期付款 | 执行中   |  

#### 2️⃣ **维度表（解释合同要素）**
- **客户维度表**  
  | 客户ID | 客户名称   | 行业     | 信用评级 |  
  |--------|------------|----------|----------|  
  | KH1001 | 华为云     | 科技     | AAA      |  

- **产品维度表**  
  | 产品ID | 产品名称   | 分类     | 单价     |  
  |--------|------------|----------|----------|  
  | P3002  | 云服务器   | 云计算   | 10,000/台 |  

- **时间维度表**  
  | 日期ID   | 日期        | 年份 | 季度 | 月份 |  
  |----------|-------------|------|------|------|  
  | 20231001 | 2023-10-01  | 2023 | Q4   | 10   |  

- **条款维度表**（特殊设计，存储标准条款）  
  | 条款ID | 条款类型   | 内容摘要           | 法律依据 |  
  |--------|------------|--------------------|----------|  
  | T005   | 违约责任   | 违约方支付20%违约金 | 《合同法》第XX条 |  

---

### **3秒理解关键点**  
1. **合同即事实**：记录**关键条款数据**（金额、状态）  
2. **维度解释背景**：客户、产品、时间说明“和谁签的、签了什么、何时生效”  
3. **扩展性设计**：  
   - **简单场景用星形模型**：单事实表+维度表（如只分析合同金额分布）  
   - **复杂场景用星座模型**：多事实表共享维度（如合同表+付款计划表+违约记录表）  

---

### **合同的三种建模场景**  
#### **场景1：基础星形模型**  
- **需求**：分析“2023年云计算类合同总额”  
- **结构**：  
  ```
  ★ 合同事实表  
  ├── 客户维度表  
  ├── 产品维度表  
  └── 时间维度表  
  ```  
- **查询**：关联3张表，按产品分类聚合金额  

#### **场景2：带履约跟踪的星座模型**  
- **需求**：监控“合同执行进度与付款计划的匹配度”  
- **结构**：  
  ```
  ★ 合同事实表  
  ★ 付款计划事实表  
  ★ 履约记录事实表  
  ├── 共享维度表（客户、产品、时间）  
  ```  
- **分析**：对比合同金额、实际付款金额、里程碑完成率  

#### **场景3：条款雪花模型**  
- **需求**：分析“违约责任条款引用频次与行业的关系”  
- **结构**：  
  ```
  ★ 合同事实表  
  ├── 条款维度表 → 法律依据子表  
  └── 客户维度表 → 行业分类子表  
  ```  
- **价值**：发现科技行业合同更频繁引用特定违约条款  

---

### **合同的特殊性**  
1. **条款嵌套结构**：  
   - 主合同关联补充协议（可设计为**父子事实表**，用合同ID关联）  
2. **时间维度多样性**：  
   - 需同时跟踪签约日、生效日、到期日、终止日（关联多个日期维度表）  
3. **状态变迁跟踪**：  
   - 履约状态（草稿/审批中/执行中/终止）需用**缓慢变化维度**记录历史  

---

### **典型分析场景**  
1. **风险预警**：  
   “信用评级B级以下的客户，其合同逾期率是否高于平均值？”  
   → 关联合同事实表+客户维度表+付款计划事实表  
2. **条款优化**：  
   “引用‘不可抗力’条款的合同，实际履约周期是否更长？”  
   → 分析条款类型与履约时间的关系  
3. **收入预测**：  
   “按季度统计已签合同金额 vs 实际回款金额”  
   → 对比合同事实表与财务凭证事实表  

---

### **类比理解**  
- **星形模型合同**像**购房合同**：  
  核心记录房价、买卖方、日期，附加页解释房屋位置、产权信息。  
- **星座模型合同**像**工程总包合同**：  
  主合同关联设计变更单、验收单、付款申请单等多份子单据。